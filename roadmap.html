<!doctype html> 
<html lang="ca">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Roadmap ‚Äì CTF ENTI</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .timeline {
      display: flex;
      flex-direction: column;
      gap: 20px;
      width: 80%;
      margin: 40px auto;
      position: relative;
    }

    .timeline::before {
      content: "";
      position: absolute;
      left: 18px;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--accent);
      border-radius: 2px;
    }

    .step {
      position: relative;
      background: var(--card);
      padding: 16px 20px;
      border-radius: var(--radius);
      box-shadow: var(--card-shadow);
      margin-left: 40px;
      cursor: pointer;
      transition: 0.2s;
    }

    .step:hover { transform: scale(1.02); }

    .step::before {
      content: "";
      position: absolute;
      left: -26px;
      top: 18px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 12px var(--accent);
    }

    .step-title { font-weight: 800; font-size: 16px; color: #f0e8ff; }
    .step-category { color: var(--muted); font-size: 13px; }

    .checkmark {
      position: absolute;
      right: 15px;
      top: 15px;
      font-size: 20px;
      color: #00ff88;
      display: none;
    }

    .progress {
      text-align: center;
      font-weight: 700;
      margin-top: 20px;
      color: #e7fff6;
    }

    #challenge-modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      width: 90%;
      max-width: 600px;
      color: white;
      box-shadow: var(--card-shadow);
    }

    .close {
      float: right;
      cursor: pointer;
      color: var(--muted);
      font-weight: bold;
    }

    .close:hover { color: white; }

    input {
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: none;
      margin-top: 10px;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      background: var(--accent);
      color: white;
      font-weight: bold;
    }
  </style>
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <div class="logo"><img src="enti_logo.jpg" alt="Logo" /></div>
        <div style="display:flex;flex-direction:column;">
          <div style="font-weight:800;color:#e7fff6" data-key="title">CTF ENTI</div>
          <div style="font-size:12px;color:var(--muted)" data-key="subtitle">practica ¬∑ apr√®n</div>
        </div>
      </div>

      <div class="nav">
        <a href="index.html"><button data-key="nav_ctf">CTF</button></a>
        <a href="index.html#section-learning"><button data-key="nav_doc">Documentaci√≥</button></a>
        <button class="active" data-key="nav_roadmap">Roadmap</button>
      </div>
    </div>

    <div class="title-area">
      <div class="title" data-key="roadmap_title">Roadmap d'aprenentatge</div>
      <div class="subtitle" data-key="roadmap_sub">Segueix un cam√≠ aleatori de reptes CTF</div>
    </div>

    <div id="timeline" class="timeline"></div>
    <div class="progress" id="progress" data-key="progress_label">Progr√©s: 0/4</div>
  </div>

  <div id="challenge-modal">
    <div class="modal-content">
      <span class="close" id="close-modal">&times;</span>
      <h2 id="challenge-title"></h2>
      <p id="challenge-desc"></p>
      <input type="text" id="flag-input" placeholder="Introdueix la flag..." />
      <button id="submit-flag" data-key="submit_btn">Enviar</button>
      <p id="feedback"></p>
    </div>
  </div>

  <button id="lang-toggle" class="lang-switch">Catal√† / Norsk</button>

  <script>
    const translations = {
      ca: {
        title: "CTF ENTI",
        subtitle: "practica ¬∑ apr√®n",
        nav_ctf: "CTF",
        nav_doc: "Documentaci√≥",
        nav_roadmap: "Roadmap",
        roadmap_title: "Roadmap d'aprenentatge",
        roadmap_sub: "Segueix un cam√≠ aleatori de reptes CTF",
        progress_label: "Progr√©s: ",
        submit_btn: "Enviar",
        correct_flag: "‚úî Flag correcta!",
        wrong_flag: "‚ùå Flag incorrecta.",
        final_unlock: "üîí Repte Final",
        final_sub: "Desbloquejat completant tots els reptes"
      },
      no: {
        title: "CTF ENTI",
        subtitle: "praktiser ¬∑ l√¶r",
        nav_ctf: "CTF",
        nav_doc: "Dokumentasjon",
        nav_roadmap: "Roadmap",
        roadmap_title: "L√¶ringsvei",
        roadmap_sub: "F√∏lg en tilfeldig vei med CTF-utfordringer",
        progress_label: "Fremdrift: ",
        submit_btn: "Send inn",
        correct_flag: "‚úî Riktig flagg!",
        wrong_flag: "‚ùå Feil flagg.",
        final_unlock: "üîí Siste utfordring",
        final_sub: "L√•st opp etter √• ha fullf√∏rt alle utfordringer"
      }
    };

    /* üî§ Challenge translations */
    const challengeTranslations = {
      ca: [
        { title:'Xifrat C√®sar', desc:'Has rebut un missatge xifrat amb un despla√ßament desconegut. Pots descobrir la flag?', flag:'flag{cesar}', category:'Criptografia' },
        { title:'Base64', desc:'Un missatge ha estat codificat en Base64. Decodifica‚Äôl i troba la flag.', flag:'flag{base64}', category:'Criptografia' },
        { title:'Xifrat Vigen√®re', desc:'Un missatge xifrat amb una clau secreta. Pots descobrir la flag si trobes la clau!', flag:'flag{vigenere}', category:'Criptografia' },
        { title:'Codi ASCII', desc:'La flag est√† amagada en codis ASCII. Converteix-los i troba-la.', flag:'flag{ascii}', category:'Criptografia' },
        { title:'Codi Morse', desc:'Un missatge en Morse t‚Äôespera. Tradueix-lo i aconsegueix la flag.', flag:'flag{morse}', category:'Criptografia' },
        { title:'Triple Capa', desc:'Tres capes de xifrat protegeixen la flag. Pots arribar al fons?', flag:'flag{triple}', category:'Criptografia' },
        { title:'XOR Brutal', desc:'Un missatge xifrat amb XOR. Troba la clau i obt√©n la flag.', flag:'flag{xor}', category:'Criptografia' },

        /* ‚ú® Nous reptes */
        { title:'Base64 II', desc:'Tens un text codificat en Base64 guardat a la variable b64. Has de decodificar-lo per obtenir la flag en format FLAG{...}. b64 = "RkxBR3tCYXNlNjRfU2ltcGxlfQ=="', flag:'FLAG{Base64_Simple}', category:'Criptografia' },
        { title:'Hex a ASCII', desc:'Tens una cadena hexagonal a la variable hexs. Converteix cada parell de d√≠gits en el seu car√†cter ASCII corresponent. hexs = "464c41477b4865785f636f64655f4578616d706c657d"', flag:'FLAG{Hex_code_Example}', category:'Criptografia' },
        { title:'Hash MD5 simulat', desc:'Tens una llista de contrasenyes. La correcta genera el hash "5f4dcc3b5aa765d61d8327deb882cf99" (que correspon a "password"). Troba la que coincideix i forma FLAG{paraula}.', flag:'FLAG{password}', category:'Criptografia' },
        { title:'For√ßa bruta PIN', desc:'La funci√≥ check(pin) retorna True si el PIN √©s correcte. Descobreix el PIN provant totes les combinacions de 0000-9999.', flag:'FLAG{PIN_0420}', category:'An√†lisi de seguretat' },
        { title:'Detecci√≥ de patrons sospitosos (SQLi)', desc:'Analitza una llista d‚Äôintents d‚Äôinici de sessi√≥ i detecta la l√≠nia sospitosa amb la flag FLAG{...}.', flag:'FLAG{SQLI_detected}', category:'Seguretat web' },
        { title:'Extreure flag d‚Äôun script HTML', desc:'Dins d‚Äôuna p√†gina HTML hi ha un bloc script amb la flag. Has d‚Äôextreure el text FLAG{...}.', flag:'FLAG{XSS_example}', category:'An√†lisi web' },
        { title:'Detecci√≥ d‚Äôenlla√ß sospit√≥s (phishing)', desc:'Troba l‚Äôenlla√ß amb FLAG{...} dins del text.', flag:'FLAG{Phish_Example}', category:'Seguretat' },
        { title:'Esteganografia d‚Äôespais', desc:'Cada l√≠nia acaba amb un espai (0) o una tabulaci√≥ (1). Converteix els bits en car√†cters ASCII i troba la flag.', flag:'U', category:'Esteganografia' }
      ],

      no: [
        { title:'C√¶sar-kryptering', desc:'Du har mottatt en kryptert melding med ukjent forskyvning. Kan du finne flagget?', flag:'flag{cesar}', category:'Kryptografi' },
        { title:'Base64', desc:'En melding er kodet i Base64. Dekod den og finn flagget.', flag:'flag{base64}', category:'Kryptografi' },
        { title:'Vigen√®re-kryptering', desc:'En melding er kryptert med en hemmelig n√∏kkel. Finn n√∏kkelen og oppdag flagget!', flag:'flag{vigenere}', category:'Kryptografi' },
        { title:'ASCII-kode', desc:'Flagget er skjult i ASCII-koder. Konverter dem og finn det.', flag:'flag{ascii}', category:'Kryptografi' },
        { title:'Morsekode', desc:'En melding i morsekode venter. Oversett den og f√• flagget.', flag:'flag{morse}', category:'Kryptografi' },
        { title:'Trippellag', desc:'Tre lag med kryptering beskytter flagget. Kan du n√• bunnen?', flag:'flag{triple}', category:'Kryptografi' },
        { title:'XOR Angrep', desc:'En melding er kryptert med XOR. Finn n√∏kkelen og f√• flagget.', flag:'flag{xor}', category:'Kryptografi' },

        /* ‚ú® Nye utfordringer */
        { title:'Base64 II', desc:'Du har en tekst kodet i Base64 lagret i variabelen b64. Dekod den for √• f√• flagget i formatet FLAG{...}.', flag:'FLAG{Base64_Simple}', category:'Kryptografi' },
        { title:'Hex til ASCII', desc:'Du har en heksadesimal streng i variabelen hexs. Konverter hvert par siffer til tilsvarende ASCII-tegn.', flag:'FLAG{Hex_code_Example}', category:'Kryptografi' },
        { title:'Simulert MD5-hash', desc:'Du har en liste med passord. Det riktige gir hashen "5f4dcc3b5aa765d61d8327deb882cf99" (som tilsvarer "password"). Finn riktig og skriv FLAG{ord}.', flag:'FLAG{password}', category:'Kryptografi' },
        { title:'Brute-force PIN', desc:'Funksjonen check(pin) returnerer True hvis PIN er korrekt. Finn PIN ved √• teste alle kombinasjoner fra 0000 til 9999.', flag:'FLAG{PIN_0420}', category:'Sikkerhetsanalyse' },
        { title:'Oppdag mistenkelig m√∏nster (SQLi)', desc:'Analyser en liste med innloggingsfors√∏k og oppdag linjen med flagget FLAG{...}.', flag:'FLAG{SQLI_detected}', category:'Websikkerhet' },
        { title:'Trekk ut flagg fra HTML-script', desc:'Inne i en HTML-side er det et script som inneholder flagget. Finn teksten FLAG{...}.', flag:'FLAG{XSS_example}', category:'Webanalyse' },
        { title:'Oppdag phishing-lenke', desc:'Finn lenken med FLAG{...} i teksten.', flag:'FLAG{Phish_Example}', category:'Sikkerhet' },
        { title:'Mellomrom-steganografi', desc:'Hver linje slutter med et mellomrom (0) eller en tab (1). Konverter bitene til ASCII-tegn og finn flagget.', flag:'U', category:'Steganografi' }
      ]
    };

    let completed = 0;
    const total = 4;
    let currentChallenge = null;
    let currentLang = 'ca';
    let currentLangChallenges = challengeTranslations[currentLang];

    const modal = document.getElementById('challenge-modal');
    const closeModal = document.getElementById('close-modal');
    const submitBtn = document.getElementById('submit-flag');
    const feedback = document.getElementById('feedback');

    closeModal.onclick = () => { modal.style.display = 'none'; feedback.textContent = ''; };
    window.onclick = e => { if (e.target == modal) modal.style.display = 'none'; };

    const langToggle = document.getElementById('lang-toggle');
    langToggle.onclick = () => {
      currentLang = currentLang === 'ca' ? 'no' : 'ca';
      document.documentElement.lang = currentLang;
      updateLang(currentLang);
      randomRoadmap();
      updateProgress();
    };

    function updateLang(lang) {
      document.querySelectorAll("[data-key]").forEach(el => {
        const key = el.getAttribute("data-key");
        if (translations[lang][key]) el.textContent = translations[lang][key];
      });
      currentLangChallenges = challengeTranslations[lang];
    }

    function randomRoadmap() {
      const timeline = document.getElementById('timeline');
      timeline.innerHTML = '';
      const shuffled = [...currentLangChallenges].sort(() => Math.random() - 0.5).slice(0, total);
      shuffled.forEach((ch) => {
        const step = document.createElement('div');
        step.className = 'step';
        step.innerHTML = `
          <div class="step-title">${ch.title}</div>
          <div class="step-category">${ch.category}</div>
          <div class="checkmark">‚úÖ</div>
        `;
        step.addEventListener('click', () => openChallenge(ch, step));
        timeline.appendChild(step);
      });
    }

    function openChallenge(challenge, stepElement) {
      currentChallenge = { challenge, stepElement };
      document.getElementById('challenge-title').textContent = challenge.title;
      document.getElementById('challenge-desc').textContent = challenge.desc;
      document.getElementById('flag-input').value = '';
      feedback.textContent = '';
      modal.style.display = 'flex';
    }

    submitBtn.onclick = () => {
      const input = document.getElementById('flag-input').value.trim();
      const lang = document.documentElement.lang;
      if (!currentChallenge) return;
      if (input === currentChallenge.challenge.flag) {
        feedback.style.color = '#00ff88';
        feedback.textContent = translations[lang].correct_flag;
        const check = currentChallenge.stepElement.querySelector('.checkmark');
        if (check && check.style.display !== 'block') {
          check.style.display = 'block';
          completed++;
          updateProgress();
        }
        setTimeout(() => { modal.style.display = 'none'; feedback.textContent = ''; }, 800);
      } else {
        feedback.style.color = 'red';
        feedback.textContent = translations[lang].wrong_flag;
      }
    };

    function updateProgress() {
      const progress = document.getElementById('progress');
      const lang = document.documentElement.lang;
      const text = translations[lang].progress_label;
      progress.textContent = text + completed + "/" + total;
      if (completed === total) showFinalChallenge();
    }

    function showFinalChallenge() {
      const lang = document.documentElement.lang;
      const timeline = document.getElementById('timeline');
      const step = document.createElement('div');
      step.className = 'step';
      step.style.border = "1px solid gold";
      step.innerHTML = `
        <div class="step-title">${translations[lang].final_unlock}</div>
        <div class="step-category">${translations[lang].final_sub}</div>
      `;
      step.addEventListener('click', () => {
        window.location.href = "secret.html";
      });
      timeline.appendChild(step);
    }

    randomRoadmap();
  </script>
</body>
</html>
